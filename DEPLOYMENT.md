# Production Deployment Guide

## Step 1: Deploy Backend to Railway

1. Go to [Railway.app](https://railway.app)
2. Click "New Project" → "Deploy from GitHub repo"
3. Select this repository
4. Railway will auto-detect it's a Node.js app
5. Add these environment variables in Railway dashboard:
   ```
   NODE_ENV=production
   PORT=3001
   JWT_SECRET=your_production_secret_here_make_it_long_and_random
   JWT_EXPIRES_IN=7d
   FRONTEND_URL=https://your-vercel-app.vercel.app
   ```
6. Railway will automatically provision a PostgreSQL database
7. Copy the `DATABASE_URL` from Railway (it's auto-generated)
8. Railway will give you a URL like: `https://your-backend.railway.app`
9. **Save this backend URL** - you'll need it for Step 2

## Step 2: Run Database Migrations on Railway

Once backend is deployed, run migrations:

```bash
# SSH into Railway or use Railway CLI
railway run npm run migrate
railway run npm run migrate:phase2
railway run npm run migrate:phase2b
railway run node utils/create-test-users.js
```

## Step 3: Deploy Frontend to Vercel

1. Go to [Vercel.com](https://vercel.com)
2. Click "Add New Project" → "Import Git Repository"
3. Select this repository
4. Vercel will auto-detect Vite
5. Add this environment variable:
   ```
   VITE_API_URL=https://your-backend.railway.app
   ```
   (Use the backend URL from Step 1)
6. Click "Deploy"
7. Vercel will give you a URL like: `https://your-app.vercel.app`

## Step 4: Update Backend CORS

Go back to Railway and update the `FRONTEND_URL` environment variable:
```
FRONTEND_URL=https://your-app.vercel.app
```

Railway will automatically redeploy.

## Step 5: Test Production

1. Go to your Vercel URL: `https://your-app.vercel.app`
2. Login with:
   - Email: `admin@test.com`
   - Password: `admin123`

## Environment Variables Summary

### Railway Backend:
- `NODE_ENV=production`
- `PORT=3001`
- `DATABASE_URL` (auto-generated by Railway)
- `JWT_SECRET` (generate a long random string)
- `JWT_EXPIRES_IN=7d`
- `FRONTEND_URL` (your Vercel URL)

### Vercel Frontend:
- `VITE_API_URL` (your Railway backend URL)

## Quick Links

- Railway Dashboard: https://railway.app/dashboard
- Vercel Dashboard: https://vercel.com/dashboard
- Railway CLI Docs: https://docs.railway.app/develop/cli
- Vercel CLI Docs: https://vercel.com/docs/cli

---

## Alternative: Deploy via CLI

If you prefer command line:

### Deploy Backend (Railway):
```bash
cd backend
railway login
railway init
railway up
railway run npm run migrate
railway run node utils/create-test-users.js
```

### Deploy Frontend (Vercel):
```bash
vercel login
vercel --prod
```
